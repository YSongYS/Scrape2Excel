{"version":3,"sources":["webpack:///webpack/bootstrap 97f71bbac360f8da949b","webpack:///./xls-export.js"],"names":["XlsExport","data","title","Array","isArray","Object","prototype","toString","call","Error","_data","_title","fileName","TEMPLATE_XLS","MIME_XLS","parameters","table","objectToTable","computeOutput","replace","x","y","downloadFile","toBase64","MIME_CSV","encodeURIComponent","objectToSemicolons","output","link","document","createElement","body","appendChild","download","href","click","string","window","btoa","unescape","colsHead","keys","map","key","join","colsData","obj","col","trim"],"mappings":"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","file":"xls-export.es5.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 97f71bbac360f8da949b","/**\n * __  ___     _____                       _\n * \\ \\/ / |___| ____|_  ___ __   ___  _ __| |_\n *  \\  /| / __|  _| \\ \\/ / '_ \\ / _ \\| '__| __|\n *  /  \\| \\__ \\ |___ >  <| |_) | (_) | |  | |_\n * /_/\\_\\_|___/_____/_/\\_\\ .__/ \\___/|_|   \\__|\n *                       |_|\n * 6/12/2017\n * Daniel Blanco Parla\n * https://github.com/deblanco/xlsExport\n */\n\nclass XlsExport {\n  // data: array of objects with the data for each row of the table\n  // name: title for the worksheet\n  constructor(data, title = 'Worksheet') {\n    // input validation: new xlsExport([], String)\n    if (!Array.isArray(data) || (typeof title !== 'string' || Object.prototype.toString.call(title) !== '[object String]')) { throw new Error('Invalid input types: new xlsExport(Array [], String)'); }\n\n    this._data = data;\n    this._title = title;\n  }\n\n  set setData(data) {\n    if (!Array.isArray(data)) throw new Error('Invalid input type: setData(Array [])');\n\n    this._data = data;\n  }\n\n  get getData() {\n    return this._data;\n  }\n\n  exportToXLS(fileName = 'export.xls') {\n    if (typeof fileName !== 'string' || Object.prototype.toString.call(fileName) !== '[object String]') { throw new Error('Invalid input type: exportToCSV(String)'); }\n\n    const TEMPLATE_XLS = `\n        <html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\">\n        <meta http-equiv=\"content-type\" content=\"application/vnd.ms-excel; charset=UTF-8\"/>\n        <head><!--[if gte mso 9]><xml>\n        <x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{title}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml>\n        <![endif]--></head>\n        <body>{table}</body></html>`;\n    const MIME_XLS = 'data:application/vnd.ms-excel;base64,';\n\n    const parameters = { title: this._title, table: this.objectToTable() };\n    const computeOutput = TEMPLATE_XLS.replace(/{(\\w+)}/g, (x, y) => parameters[y]);\n\n    this.downloadFile(MIME_XLS + this.toBase64(computeOutput), fileName);\n  }\n\n  exportToCSV(fileName = 'export.csv') {\n    if (typeof fileName !== 'string' || Object.prototype.toString.call(fileName) !== '[object String]') { throw new Error('Invalid input type: exportToCSV(String)'); }\n\n    const MIME_CSV = 'data:attachament/csv,';\n    this.downloadFile(MIME_CSV + encodeURIComponent(this.objectToSemicolons()), fileName);\n  }\n\n  downloadFile(output, fileName) {\n    const link = document.createElement('a');\n    document.body.appendChild(link);\n    link.download = fileName;\n    link.href = output;\n    link.click();\n  }\n\n  toBase64(string) {\n    return window.btoa(unescape(encodeURIComponent(string)));\n  }\n\n  objectToTable() {\n    // extract keys from the first object, will be the title for each column\n    const colsHead = `<tr>${Object.keys(this._data[0]).map(key => `<td>${key}</td>`).join('')}</tr>`;\n\n    const colsData = this._data.map(obj => [`<tr>\n                ${Object.keys(obj).map(col => `<td>${obj[col] ? obj[col] : ''}</td>`).join('')}\n            </tr>`]) // 'null' values not showed\n      .join('');\n\n    return `<table>${colsHead}${colsData}</table>`.trim(); // remove spaces...\n  }\n\n  objectToSemicolons() {\n    const colsHead = Object.keys(this._data[0]).map(key => [key]).join(';');\n    const colsData = this._data.map(obj => [ // obj === row\n      Object.keys(obj).map(col => [\n        obj[col], // row[column]\n      ]).join(';'), // join the row with ';'\n    ]).join('\\n'); // end of row\n\n    return `${colsHead}\\n${colsData}`;\n  }\n}\n\n// export default XlsExport; // comment this line to babelize\n\n\n\n// WEBPACK FOOTER //\n// ./xls-export.js"],"sourceRoot":""}